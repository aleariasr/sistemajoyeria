# Nixpacks configuration for Railway deployment
# This file configures how the monorepo is built and run

[phases.setup]
nixPkgs = ["nodejs_20", "npm"]

[phases.install]
# Use root npm install which handles workspaces automatically
# Using --include=dev temporarily to ensure all dependencies are installed correctly
# NOTE: Do not use --production flag as it's deprecated. Use --omit=dev if needed.
cmds = ["npm ci"]

[start]
# Using direct node command instead of npm workspace to avoid
# "No workspaces found" error in some Railway/Nixpacks environments
cmd = "node backend/server.js"
